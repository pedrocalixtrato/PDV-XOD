package dc.visao.ponto;

import java.util.List;

import org.vaadin.addons.maskedtextfield.NumericField;

import com.vaadin.annotations.AutoGenerated;
import com.vaadin.data.Container;
import com.vaadin.ui.Component;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.Field;
import com.vaadin.ui.GridLayout;
import com.vaadin.ui.TableFieldFactory;
import com.vaadin.ui.TextField;
import com.vaadin.ui.VerticalLayout;

import dc.controller.ponto.PontoEscalaFormController;
import dc.entidade.ponto.PontoEscala;
import dc.entidade.ponto.PontoTurma;
import dc.visao.framework.component.SubFormComponent;
import dc.visao.framework.util.ComponentUtil;

public class PontoEscalaFormView extends CustomComponent {

	/*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;
	@AutoGenerated
	private VerticalLayout mainLayout;
	@AutoGenerated
	private GridLayout gridLayout_1;
	@AutoGenerated
	private SubFormComponent<PontoTurma, Integer> subFormComponent;
	@AutoGenerated
	private GridLayout gridLayout_2;
	private PontoEscalaFormController controller;
	@AutoGenerated
	private NumericField txDescontoHoraDia;
	@AutoGenerated
	private NumericField txDescontoDSR;
	@AutoGenerated
	private NumericField txCodigoHorarioDomingo;
	@AutoGenerated
	private NumericField txCodigoHorarioSegunda;
	@AutoGenerated
	private NumericField txCodigoHorarioTerca;
	@AutoGenerated
	private NumericField txCodigoHorarioQuarta;
	@AutoGenerated
	private NumericField txCodigoHorarioQuinta;
	@AutoGenerated
	private NumericField txCodigoHorarioSexta;
	@AutoGenerated
	private NumericField txCodigoHorarioSabado;
	@AutoGenerated
	private TextField txNome;

	/**
	 * The constructor should first build the main layout, set the composition
	 * root and then do any custom initialization.
	 * 
	 * The constructor will not be automatically regenerated by the visual
	 * editor.
	 */
	public PontoEscalaFormView(PontoEscalaFormController controller) {
		this.controller = controller;
		buildMainLayout();
		setCompositionRoot(mainLayout);
	}

	@AutoGenerated
	private VerticalLayout buildMainLayout() {
		// common part: create layout
		mainLayout = new VerticalLayout();
		mainLayout.setImmediate(false);
		mainLayout.setSizeFull();
		mainLayout.setMargin(false);
		mainLayout.setSpacing(true);
		// top-level component properties
		setWidth("100.0%");
		setHeight("100.0%");

		// gridLayout_1
		gridLayout_1 = buildGridLayout_1();
		mainLayout.addComponent(gridLayout_1);

		subFormComponent = buildSubForm();
		subFormComponent.setSizeFull();
		mainLayout.addComponent(subFormComponent);
		mainLayout.setExpandRatio(subFormComponent, 1);

		return mainLayout;
	}

	@AutoGenerated
	private GridLayout buildGridLayout_1() {
		// common part: create layout
		gridLayout_1 = new GridLayout();
		gridLayout_1.setImmediate(false);
		gridLayout_1.setSpacing(true);
		gridLayout_1.setWidth("100%");

		gridLayout_1.setRows(2);

		// gridLayout_2
		gridLayout_2 = buildGridLayout_2();
		gridLayout_1.addComponent(gridLayout_2, 0, 0);

		return gridLayout_1;
	}

	@AutoGenerated
	private GridLayout buildGridLayout_2() {
		// common part: create layout
		gridLayout_2 = new GridLayout();
		gridLayout_2.setImmediate(false);
		gridLayout_2.setSpacing(true);
		gridLayout_2.setWidth("100%");
		gridLayout_2.setColumns(7);
		gridLayout_2.setRows(2);

		// txQuantidade
		txNome = ComponentUtil.buildTextField("Nome");
		gridLayout_2.addComponent(txNome, 0, 0);

		txDescontoHoraDia = ComponentUtil.buildNumericField("Desconto Hora Dia");
		gridLayout_2.addComponent(txDescontoHoraDia, 1, 0);

		// txSaldo
		txDescontoDSR = ComponentUtil.buildNumericField("Desconto DSR");
		gridLayout_2.addComponent(txDescontoDSR, 2, 0);

		txCodigoHorarioDomingo = ComponentUtil.buildNumericField("Código Horário Domingo");
		gridLayout_2.addComponent(txCodigoHorarioDomingo, 0, 1);

		txCodigoHorarioSegunda = ComponentUtil.buildNumericField("Código Horário Segunda");
		gridLayout_2.addComponent(txCodigoHorarioSegunda, 1, 1);

		txCodigoHorarioTerca = ComponentUtil.buildNumericField("Código Horário Terça");
		gridLayout_2.addComponent(txCodigoHorarioTerca, 2, 1);

		txCodigoHorarioQuarta = ComponentUtil.buildNumericField("Código Horário Quarta");
		gridLayout_2.addComponent(txCodigoHorarioQuarta, 3, 1);

		txCodigoHorarioQuinta = ComponentUtil.buildNumericField("Código Horário Quinta");
		gridLayout_2.addComponent(txCodigoHorarioQuinta, 4, 1);

		txCodigoHorarioSexta = ComponentUtil.buildNumericField("Código Horário Sexta");
		gridLayout_2.addComponent(txCodigoHorarioSexta, 5, 1);

		txCodigoHorarioSabado = ComponentUtil.buildNumericField("Código Horário Sábado");
		gridLayout_2.addComponent(txCodigoHorarioSabado, 6, 1);

		return gridLayout_2;
	}

	private SubFormComponent<PontoTurma, Integer> buildSubForm() {
		SubFormComponent<PontoTurma, Integer> subForm = new SubFormComponent<PontoTurma, Integer>(PontoTurma.class,
				new String[] { "codigo", "nome" }, new String[] { "Código", "Nome" }) {

			private static final long serialVersionUID = 1L;

			@Override
			protected TableFieldFactory getFieldFactory() {
				return new TableFieldFactory() {

					/**
					 * 
					 */
					private static final long serialVersionUID = 1L;

					@Override
					public Field<?> createField(Container container, Object itemId, Object propertyId, Component uiContext) {

						if ("codigo".equals(propertyId)) {
							
							NumericField textField = new NumericField();
							textField.setNullRepresentation("");
							textField.setImmediate(true);
							textField.setMaxLength(3);
							
							return textField;
						} else if ("nome".equals(propertyId)) {
							TextField textField = new TextField();
							textField.setSizeFull();
							textField.setNullRepresentation("");
							return textField;
						}

						return null;
					}

				};
			}

			@Override
			public boolean validateItems(List<PontoTurma> items) {
				return true;
			}

			protected PontoTurma getNovo() {
				PontoTurma pontoEscalaUtilizacao = controller.novoPontoTurma();
				return pontoEscalaUtilizacao;
			}

			protected void getRemoverSelecionados(List<PontoTurma> values) {
				controller.removerPontoTurma(values);
			}
		};

		return subForm;
	}

	public void preencheForm(PontoEscala currentBean) {

		txCodigoHorarioDomingo.setValue(currentBean.getCodigoHorarioDomingo());
		txCodigoHorarioSegunda.setValue(currentBean.getCodigoHorarioSegunda());
		txCodigoHorarioTerca.setValue(currentBean.getCodigoHorarioTerca());
		txCodigoHorarioQuarta.setValue(currentBean.getCodigoHorarioQuarta());
		txCodigoHorarioQuinta.setValue(currentBean.getCodigoHorarioQuinta());
		txCodigoHorarioSexta.setValue(currentBean.getCodigoHorarioSexta());
		txCodigoHorarioSabado.setValue(currentBean.getCodigoHorarioSabado());
		txDescontoDSR.setValue(currentBean.getDescontoDsr());
		txDescontoHoraDia.setValue(currentBean.getDescontoHoraDia());
		txNome.setValue(currentBean.getNome());

		fillSubForm(currentBean.getPontoTurmas());

	}

	public void fillSubForm(List<PontoTurma> pontoTurmas) {
		this.subFormComponent.fillWith(pontoTurmas);

	}

	public void preencheBean(PontoEscala currentBean) {
		currentBean.setCodigoHorarioDomingo(txCodigoHorarioDomingo.getValue());
		currentBean.setCodigoHorarioSegunda(txCodigoHorarioSegunda.getValue());
		currentBean.setCodigoHorarioTerca(txCodigoHorarioTerca.getValue());
		currentBean.setCodigoHorarioQuarta(txCodigoHorarioQuarta.getValue());
		currentBean.setCodigoHorarioQuinta(txCodigoHorarioQuinta.getValue());
		currentBean.setCodigoHorarioSexta(txCodigoHorarioSexta.getValue());
		currentBean.setCodigoHorarioSabado(txCodigoHorarioSabado.getValue());
		currentBean.setDescontoDsr(txDescontoDSR.getValue());
		currentBean.setDescontoHoraDia(txDescontoHoraDia.getValue());
		currentBean.setNome(txNome.getValue());
	}

	public NumericField getTxDescontoHoraDia() {
		return txDescontoHoraDia;
	}

	public void setTxDescontoHoraDia(NumericField txDescontoHoraDia) {
		this.txDescontoHoraDia = txDescontoHoraDia;
	}

	public NumericField getTxDescontoDSR() {
		return txDescontoDSR;
	}

	public void setTxDescontoDSR(NumericField txDescontoDSR) {
		this.txDescontoDSR = txDescontoDSR;
	}

	public NumericField getTxCodigoHorarioDomingo() {
		return txCodigoHorarioDomingo;
	}

	public void setTxCodigoHorarioDomingo(NumericField txCodigoHorarioDomingo) {
		this.txCodigoHorarioDomingo = txCodigoHorarioDomingo;
	}

	public NumericField getTxCodigoHorarioSegunda() {
		return txCodigoHorarioSegunda;
	}

	public void setTxCodigoHorarioSegunda(NumericField txCodigoHorarioSegunda) {
		this.txCodigoHorarioSegunda = txCodigoHorarioSegunda;
	}

	public NumericField getTxCodigoHorarioTerca() {
		return txCodigoHorarioTerca;
	}

	public void setTxCodigoHorarioTerca(NumericField txCodigoHorarioTerca) {
		this.txCodigoHorarioTerca = txCodigoHorarioTerca;
	}

	public NumericField getTxCodigoHorarioQuarta() {
		return txCodigoHorarioQuarta;
	}

	public void setTxCodigoHorarioQuarta(NumericField txCodigoHorarioQuarta) {
		this.txCodigoHorarioQuarta = txCodigoHorarioQuarta;
	}

	public NumericField getTxCodigoHorarioQuinta() {
		return txCodigoHorarioQuinta;
	}

	public void setTxCodigoHorarioQuinta(NumericField txCodigoHorarioQuinta) {
		this.txCodigoHorarioQuinta = txCodigoHorarioQuinta;
	}

	public NumericField getTxCodigoHorarioSexta() {
		return txCodigoHorarioSexta;
	}

	public void setTxCodigoHorarioSexta(NumericField txCodigoHorarioSexta) {
		this.txCodigoHorarioSexta = txCodigoHorarioSexta;
	}

	public NumericField getTxCodigoHorarioSabado() {
		return txCodigoHorarioSabado;
	}

	public void setTxCodigoHorarioSabado(NumericField txCodigoHorarioSabado) {
		this.txCodigoHorarioSabado = txCodigoHorarioSabado;
	}

	public TextField getTxNome() {
		return txNome;
	}

	public void setTxNome(TextField txNome) {
		this.txNome = txNome;
	}

}
